# Витрина RFM

## 1.1. Выясните требования к целевой витрине.

{См. задание на платформе}

-----------

Что сделать: разработать витрину данных для RFM-классификации пользователей приложения
За какой период: с начала 2022 и по текущие момент
Где должна распологаться: в схеме analysis
Как назвать: назвать витрину необходимо dm_rfm_segments
Какие поля необходимы:
    - user_id
    - recency (число от 1 до 5) -> измеряется по последнему заказу; значение 1 получат те, кто либо вообще не делал заказов, либо делал их очень давно, а 5 — те, кто заказывал относительно недавно
    - frequency (число от 1 до 5) -> оценивается по количеству заказов; значение 1 получат клиенты с наименьшим количеством заказов, а 5 — с наибольшим
    - monetary_value (число от 1 до 5) -> оценивается по потраченной сумме; значение 1 получат клиенты с наименьшей суммой, а 5 — с наибольшей
Дополнительные условия: 
    - количество клиентов в каждом сегменте должно быть одинаковым. В случае, если количество заказов у двух пользователей одинаковое, но они должны попасть в разные категории, то не важно, кого поставить ниже, а кого выше. Аналогично и для других показателей
    - обновления для данной витрины не нужны
    - успешно выполненный заказ - это заказ со статусом "Closed"


## 1.2. Изучите структуру исходных данных.

{См. задание на платформе}

-----------

Поля, которые будут использованы для расчета метрик:
    - user_id (для хранения идентификатора пользоателя)
    - order_ts (таблица orders; для определения даты, когда был сделан заказ)
    - order_id (таблица orders; для определения количества заказов, сделанных одним пользователем)
    - payment (таблица orders; для определения суммы, потраченной каждым пользователем)


## 1.3. Проанализируйте качество данных

{См. задание на платформе}
-----------

См. файл data_quality.md


## 1.4. Подготовьте витрину данных

{См. задание на платформе}

### 1.4.1. Сделайте VIEW для таблиц из базы production.**

{См. задание на платформе}

См. файл views.sql

### 1.4.2. Напишите DDL-запрос для создания витрины.**

{См. задание на платформе}

См. файл datamart_ddl.sql

### 1.4.3. Напишите SQL запрос для заполнения витрины

{См. задание на платформе}

См. файл datamart_query.sql
